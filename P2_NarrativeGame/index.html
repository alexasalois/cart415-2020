<DOCTYPE html>
<html>
<head>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

	<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>

    // HOME SCREEN //
    $( document ).ready(function() {
      $("#level1").css("display", "none");
      $("#level2").css("display", "none");
      $("#level3").css("display", "none");
    });

    // START BUTTON //
    function startGame() {
      $("#mainMenu").css("display", "none");
      miniGame1();

      var song = document.getElementById("bgMusic");
            song.play();
            song.addEventListener('ended', function() {
              this.currentTime = 0;
              this.play();
            }, false);
    }

    // FIRST MINI GAME: just wait... //
    function miniGame1() {
      $("#environment1").css("display","block");

      $( "#thought1" ).dialog();
        setTimeout(function () {
        $( "#thought2" ).dialog();
        }, 4000);
          setTimeout(function () {
          $( "#thought3" ).dialog();
          }, 7000);
            setTimeout(function () {
            $( "#thought4" ).dialog();
            }, 10000);
          setTimeout(function () {
          $( "#thought5" ).dialog();
          }, 13000);

        setTimeout(
        miniGame2, 17000);
      }

    // SECOND MINI GAME: paying bus fare //
    function miniGame2 () {
      $("#level1").css("display","block");
      $("#miniGame2").css("display", "block");

      $("#level1End").css("display", "none");
      $("#miniGame1").css("display", "none");
      $("#miniGame3").css("display", "none");
      $("#miniGame4").css("display", "none");


        $( "#money" ).draggable();
        $( "#notdraggable" ).draggable();
        $( "#notdraggable2" ).draggable();
        $( "#notdraggable3" ).draggable();

              $( "#droppable" ).droppable({
                accept: "#money",

                drop: function( event, ui ) {
                  $( this )
                    $("#draggable").css("display","none");
                    setTimeout(miniGame3,3000);
                }
              });
            }

    function miniGame3() {
      $("#miniGame2").css("display", "none");
      $("#miniGame3").css("display", "block");

      $("#halfeyes").css("display", "none");
      $("#openedeyes").css("display", "none");

    }

    var sleepPoints = 0;
    function addPoints() {
      sleepPoints++;
      setTimeout(pointSystem,2000);
    }

    function pointSystem() {
      sleepPoints = sleepPoints - 1;

      if (sleepPoints < 6 && sleepPoints > 2) {
        $("#halfeyes").css("display", "block");
        $("#closedeyes").css("display", "none");
        $("#openedeyes").css("display", "none");
      }


      if (sleepPoints > 5) {
        $("#halfeyes").css("display", "none");
        $("#closedeyes").css("display", "none");
        $("#openedeyes").css("display", "block");

        console.log("success!");
        setTimeout(miniGame4,3000);
      }
    }

    function miniGame4() {
      $("#miniGame3").css("display", "none");
      $("#miniGame4").css("display", "block");

        $( function() {
          var slider = $( "#miniGameSlider" ).slider({
            min: 0,
            max: 100,
            step: 10,
            slide: function(event, ui) {
              $("#miniGameSlider" ).val( ui.value );
              $("#value").html(ui.value);

              var sliderValue = ui.value;

              if (sliderValue = 70) {
                setTimeout(endOfLevel1,2000);
              }
            }
          });
        });
      }

      function endOfLevel1() {
        $("#miniGame4").css("display", "none");
        $("#level1End").css("display", "block");

        setTimeout(miniGame1_medium,3000);
      }


      function miniGame1_medium() {
        $("#level2").css("display", "block");
        $("#miniGame1_medium").css("display", "block");

        $("#level1End").css("display", "none");
        $("#level1").css("display", "none");
        $("#miniGame2_medium").css("display", "none");
        $("#miniGame3_medium").css("display", "none");
        $("#miniGame4_medium").css("display", "none");
        $("#level2End").css("display", "none");


        $( "#thought6" ).dialog();
          setTimeout(function () {
          $( "#thought7" ).dialog();
          }, 4000);
            setTimeout(function () {
            $( "#thought8" ).dialog();
            }, 7000);
              setTimeout(function () {
              $( "#thought9" ).dialog();
              }, 10000);
            setTimeout(function () {
            $( "#thought10" ).dialog();
            }, 13000);

            setTimeout(miniGame2_medium,17000);
      }

      function miniGame2_medium() {
        $("#level1").css("display","block");
        $("#miniGame2_medium").css("display", "block");

        $("#miniGame1_medium").css("display", "none");
        $("#miniGame3_medium").css("display", "none");
        $("#miniGame4_medium").css("display", "none");


          $( "#draggable2" ).draggable();
          $( "#droppable2" ).droppable({
              drop: function( event, ui ) {
              $( this )
              .addClass( "ui-state-highlight" )
              .find( "p" )
              .html( "correct fare!" );
              $("#draggable2").css("display","none");
              setTimeout(miniGame3_medium,3000);
              }
            });
          }

        function miniGame3_medium() {
          $("#miniGame2_medium").css("display", "none");
          $("#miniGame3_medium").css("display", "block");
          }

          var sleepPoints2 = 0;
          function addPoints2() {
          sleepPoints2++;
          setTimeout(pointSystem2,2000);
          }

          function pointSystem2() {
          sleepPoints2 = sleepPoints2 - 1;

          if (sleepPoints2 > 8) {
            console.log("success!");
            miniGame4_medium();
          }
        }

        function miniGame4_medium() {
          $("#miniGame3_medium").css("display", "none");
          $("#miniGame4_medium").css("display", "block");

            $( function() {
              var slider2 = $( "#miniGameSlider2" ).slider({
                min: 0,
                max: 100,
                step: 5,
                slide: function(event, ui) {
                  $("#miniGameSlider2" ).val( ui.value );
                  $("#value2").html(ui.value);

                  var sliderValue2 = ui.value;

                  if (sliderValue2 = 45) {
                    setTimeout(endOfLevel2,2000);
                  }
                }
              });
            });
          }

        function endOfLevel2() {
          $("#miniGame4_medium").css("display", "none");
          $("#level2End").css("display", "block");

          setTimeout(miniGame1_hard,3000);
        }

        function miniGame1_hard() {
          $("#level3").css("display", "block");
          $("#miniGame1_hard").css("display", "block");

          $("#level2End").css("display", "none");
          $("#level2").css("display", "none");
          $("#miniGame2_hard").css("display", "none");
          $("#miniGame3_hard").css("display", "none");
          $("#miniGame4_hard").css("display", "none");

          $( "#thought11" ).dialog();
            setTimeout(function () {
            $( "#thought12" ).dialog();
            }, 4000);
              setTimeout(function () {
              $( "#thought13" ).dialog();
              }, 7000);
                setTimeout(function () {
                $( "#thought14" ).dialog();
                }, 10000);
              setTimeout(function () {
              $( "#thought15" ).dialog();
              }, 13000);

              //setTimeout(miniGame2_medium,17000);
        }


</script>
</head>

<body>

  <audio id="bgMusic">
    <source src="assets/sounds/fall_8bit_drone.mp3" type="audio/mpeg">
  </audio>

<div id="game">

<!-- HOME SCREEN -->
<div id="mainMenu">
  <h2>my game</h2>
  <br>
  <br>
  <p>blabla rules / ominous quote</p>
  <br>
  <button onclick="startGame()">Click to Start</button>
</div>

<!-- LEVEL 1 -->
<div id="level1">

  <!-- FIRST MINI GAME: WAIT FOR THE BUS! -->
  <div id="miniGame1">
    <div id="thought1" title="?#%^*$!)#*()">
      <p>How long do I have to wait here for?</p>
    </div>
    <div id="thought2" title="#$%^*(%^))">
      <p>I'm cold.</p>
    </div>
    <div id="thought3" title="^!@#$@*$***()">
      <p>Hmm, not sure what I'll make for dinner tonight.</p>
    </div>
    <div id="thought4" title="!@##$%^()())">
      <p>That tree looks cool.</p>
    </div>
    <div id="thought5" title="**^%$$##^))">
      <p>Why is the bus always late?</p>
    </div>


  </div>

  <!-- SECOND MINI GAME: GET ON BUS - PAY FOR BUS FARE -->
  <div id="miniGame2">
    <p>pay for your fare!</p>
    <div id="draggable">
      <img id="money" src="assets/images/coin_small.png">
    </div>

    <div id="notdraggable">
      <img id="candy" src="assets/images/candyredo.png">
    </div>

    <div id="notdraggable2">
      <img id="bug" src="assets/images/bugredo.png">
    </div>

    <div id="notdraggable3">
      <img id="picture" src="assets/images/picture_small.png">
    </div>

    <div id="droppable">
      <img id="hand" src="assets/images/hand.png">
    </div>
  </div>

  <!-- THIRD MINI GAME: BUS RIDE -->
  <div id="miniGame3">
    <p>don't fall asleep.</p>
    <br>
    <p>spam the button quickly to stay awake.</p>
    <br>
    <br>
    <button id="sleepy" onclick="addPoints()">Open Your Eyes</button>

    <img id="closedeyes" src="assets/images/closed.png">
    <img id="halfeyes" src="assets/images/halfopened.png">
    <img id="openedeyes" src="assets/images/opened.png">
  </div>

  <!-- FOURTH MINI GAME: GET OFF THE BUS -->
  <div id="miniGame4">
    <p>Time to get off the bus. Bus stop number 70...</p>
    <br>
    <div id="miniGameSlider"></div>
    <div id="value">Value: </div>
  </div>

  <div id="level1End">
    <p>H0me?</p>
    <br>
    <br>
    <br>
    <p>"Not that it was beautiful, <br> but that, in the end, <br> there was a certain sense of order there;"</p>
  </div>
</div>
<!-- END OF LEVEL 1 -->

<div id="level2">
  <div id="miniGame1_medium">
      <div id="thought6" title="?#%^*$!)#*()">
        <p>Who was that?</p>
      </div>
      <div id="thought7" title="#$%^*(%^))">
        <p>I think they were looking at me.</p>
      </div>
      <div id="thought8" title="^!@#$@*$***()">
        <p>Do I look weird? I hope I'm not making it weird.</p>
      </div>
      <div id="thought9" title="!@##$%^()())">
        <p>When is the bus coming?</p>
      </div>
      <div id="thought10" title="**^%$$##^))">
        <p>Wait, why am I taking the bus again?</p>
      </div>
  </div>

  <div id="miniGame2_medium">
    <p>pay!^ for your fa&re!</p>
    <div id="draggable2" class="ui-widget-content">
      <p>money</p>
    </div>

    <div id="droppable2" class="ui-widget-header">
      <p>bus driver</p>
    </div>
  </div>

  <div id="miniGame3_medium">
    <p>don't</p>
    <p>fall</p>
    <p>asleep.</p>
    <p>sp@m the button! kee p your eyes 0penN!</p>
    <br>
    <br>
    <button id="sleepy2" onclick="addPoints2()">OpenNn Y our  Ey3s</button>
  </div>

  <div id="miniGame4_medium">
    <p>Time to get off the bus!dontgetoFfthEbUS:)) Bus stop number 45#!</p>
    <div id="miniGameSlider2"></div>
    <div id="value2">Value: </div>
  </div>

  <div id="level2End">
    <p>hom3!!:) <br><br>you ?made it ?? 'home?'</p>
    <br>
    <br>
    <br>
    <p>something worth learning
<br>in that narrow diary of my mind,
<br>in the commonplaces of the asylum
<br>where the cracked mirror
<br>or my own selfish death
<br>outstared me . . .</p>
  </div>

</div>

<div id="level3">
  <div id="miniGame1_hard">
    <div id="thought11" title="?#%^*$!)#*()">
      <p>Who the fuck was that</p>
    </div>
    <div id="thought12" title="#$%^*(%^))">
      <p>Who was that</p>
    </div>
    <div id="thought13" title="^!@#$@*$***()">
      <p>They're following me</p>
    </div>
    <div id="thought14" title="!@##$%^()())">
      <p>I think he's following me</p>
    </div>
    <div id="thought15" title="**^%$$##^))">
      <p>Stop following me</p>
    </div>
  </div>

  <div id="miniGame2_hard">
    <p>game 2 hard</p>
  </div>

  <div id="miniGame3_hard">
    <p>game 3 hard</p>
  </div>

  <div id="miniGame4_hard">
    <p>game 4 hard</p>
  </div>
<div/>
</div>

</div>

</body>

</html>
